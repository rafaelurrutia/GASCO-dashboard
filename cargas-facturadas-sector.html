<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="">
    <meta name="author" content="">

    <title>GASCO</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/libs/animate.css" rel="stylesheet">
    <link href="css/libs/rangeslider.css" rel="stylesheet">
    <link href="css/libs/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

    <script src="https://use.fontawesome.com/3613ac0212.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>


    <main>
        <header>
            <nav class="top_menu">
                <ul>
                    <li><a href="#">Catálogo de productos</a></li>
                    <li><a href="#">Manuales y fichas técnicas</a></li>
                    <li><a href="#"><i class="fa fa-envelope" aria-hidden="true"></i> Contactar ejecutivo</a></li>
                </ul>
            </nav>
            <nav class="bottom_menu">
                <div class="col-md-2 col-sm-4 col-xs-8">
                    <img src="img/logo-Gasco.png" class="img-responsive" alt="">
                </div>
                <div class="col-md-7 col-sm-7 menu-option">
                    <div class="content_menu">
                        <ul>
                            <li class="active"><a href="#"><i class="fa fa-home" aria-hidden="true"></i><span class="visible-xs-inline-block visible-sm-inline-block">Inicio</span></a></li>
                            <li><a href="#">Niveles de estanque</a></li>
                            <li><a href="#">Pedidos</a></li>
                            <li><a href="#">Cargas facturadas</a></li>
                            <li><a href="#">Facturas y documentos</a></li>
                            <li><a href="#">Gestión de cuenta</a></li>
                        </ul>
                        <ul class="visible-xs visible-sm">
                            <li>
                                <a href="#"><i class="fa fa-power-off" aria-hidden="true"></i><span class="visible-xs-inline-block visible-sm-inline-block">Cerrar sesión</span></a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-3 col-sm-8 col-xs-4">
                    <a href="" class="notificaciones">
                        <i class="fa fa-bell" aria-hidden="true"></i>
                        <span>33</span>
                    </a>

                    <button class="menu-mobile c-hamburger--htx visible-xs-inline-block visible-sm-inline-block"> 
                  <span>toggle menu</span>
                </button>

                    <a href="" class="usuario hidden-xs hidden-sm">
                        <img src="img/avatar.png" alt="">
                        <span>Nombre usuario <i class="fa fa-caret-down"></i></span>
                    </a>

                    <a href="#" class="cerrar-sesion hidden-xs hidden-sm"><i class="fa fa-power-off" aria-hidden="true"></i><span class="">Cerrar sesión</span></a>
                </div>
            </nav>
        </header>
        <section>
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h2><i class="fa fa-arrow-left" aria-hidden="true"></i> Historial de cargas facturadas <strong>sector Los Guindos</strong></h2>
                    </div>
                </div>
            </div>
        </section>

        <section class="filtro-busqueda style-3">
            <div class="container">
                <div class="row">
                    <div class="col-md-4 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <span>Desde</span>
                            <div class="input-group date" id="datetimepicker1">
                                <input type="text" class="form-control">
                                <span class="input-group-addon">
                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6 col-xs-12">
                        <div class="form-group">
                            <span>Hasta</span>
                            <div class="input-group date" id="datetimepicker2">
                                <input type="text" class="form-control">
                                <span class="input-group-addon">
                    <i class="fa fa-calendar" aria-hidden="true"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="componente-grafico style-1">

            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="top">
                            <h3 class="pull-left">Cargas facturadas mes de Enero <small><span><span class="hidden-xs hidden-sm">|</span> Totales: </span>200 Cargas, 40.000 Litros, $24.000.000.000 (CLP).</small></h3>
                            <div class="periodo historial-cargas-sector center-xs">
                                <a class="active mes" href="#" role="button">Mes</a>
                                <a class=" ano" href="#" role="button">Año</a>
                            </div>
                        </div>
                        <div id="historial-cargas-sector"></div>
                        <div class="bottom">
                            <div class="componente-checkbox">
                                <input type="checkbox" name="checkbox1" id="checkbox1" class="ios-toggle" checked="">
                                <label for="checkbox1" class="checkbox-label" data-off="off" data-on="on">
                        <i class="glyphicon glyphicon-ok"></i>
                    </label>
                            </div>
                            <label for="checkbox1"><span>Mostrar estanques en el gráfico</span></label>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="componente-tabla style-div style-7">

            <div class="container">
                <div class="row table-titulo">
                    <h3>Detalle de litros y costos facturados</h3>
                </div>

                <div class="table-content">
                    <div class="row table-children show">
                        <div class="row table-header hidden-xs">
                            <div class="col-md-3 col-sm-3 col-md-offset-1 col-sm-offset-1">
                                <strong>Ubicación</strong>
                            </div>
                            <div class="col-md-2 col-sm-2">
                                <strong>Cargas</strong>
                            </div>
                            <div class="col-md-2 col-sm-2">
                                <strong>Litros</strong>
                            </div>
                            <div class="col-md-4 col-sm-4">
                                <strong>Costo (CLP)</strong>
                            </div>
                        </div>
                        <div class="row table-parent-row">
                            <div class="col-md-1 col-sm-1 col-xs-2 text-left">
                                <div class="checkbox">
                                    <label>
                                <input type="checkbox">
                            </label>
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-3 col-xs-10">
                                <strong>Los Peumos </strong><strong class="visible-xs-inline">(50 cargos)</strong>
                            </div>
                            <div class="col-md-2 col-sm-2 hidden-xs">
                                <strong>50</strong>
                            </div>
                            <div class="col-md-2 col-sm-2 col-sm-offset-0 hidden-xs">
                                <strong>10.000</strong>
                            </div>
                            <div class="col-md-3 col-sm-3 col-sm-offset-0 hidden-xs">
                                <strong>$600.000.000</strong>
                            </div>
                            <div class="col-md-1 col-sm-1 hidden-xs text-right">
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="row table-row">
                            <div class="col-md-1 col-sm-1 col-xs-1 text-center">
                                <div class="checkbox">
                                    <label>
                                <input type="checkbox">
                            </label>
                                </div>
                            </div>

                            <div class="visible-xs col-xs-5">
                                <b class="visible-xs-inline">Estanque </b>
                            </div>
                            <div class="col-md-3 col-sm-3 col-xs-5">
                                <em>V1234567</em>
                            </div>
                            <div class="visible-xs col-xs-5">
                                <b class="visible-xs-inline">Cargas </b>
                            </div>
                            <div class="col-md-2 col-sm-2 col-xs-5">
                                <em>25</em>
                            </div>
                            <div class="visible-xs col-xs-5 col-xs-offset-1">
                                <b class="visible-xs-inline">Litros </b>
                            </div>
                            <div class="col-md-2 col-sm-2 col-sm-offset-0 col-xs-5">
                                <em>5.000</em>
                            </div>
                            <div class="visible-xs col-xs-5 col-xs-offset-1">
                                <b class="visible-xs-inline">Costo </b>
                            </div>
                            <div class="col-md-3 col-sm-3 col-xs-5">
                                <em>$300.000.000</em>
                            </div>
                            <div class="col-md-1 col-sm-1 col-xs-1 text-right">
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="row table-row">
                            <div class="col-md-1 col-sm-1 col-xs-1 text-center">
                                <div class="checkbox">
                                    <label>
                                <input type="checkbox">
                            </label>
                                </div>
                            </div>

                            <div class="visible-xs col-xs-5">
                                <b class="visible-xs-inline">Estanque </b>
                            </div>
                            <div class="col-md-3 col-sm-3 col-xs-5">
                                <em>V1234567</em>
                            </div>
                            <div class="visible-xs col-xs-5">
                                <b class="visible-xs-inline">Cargas </b>
                            </div>
                            <div class="col-md-2 col-sm-2 col-xs-5">
                                <em>25</em>
                            </div>
                            <div class="visible-xs col-xs-5 col-xs-offset-1">
                                <b class="visible-xs-inline">Litros </b>
                            </div>
                            <div class="col-md-2 col-sm-2 col-sm-offset-0 col-xs-5">
                                <em>5.000</em>
                            </div>
                            <div class="visible-xs col-xs-5 col-xs-offset-1">
                                <b class="visible-xs-inline">Costo </b>
                            </div>
                            <div class="col-md-3 col-sm-3 col-xs-5">
                                <em>$300.000.000</em>
                            </div>
                            <div class="col-md-1 col-sm-1 col-xs-1 text-right">
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </section>



    </main>

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/libs/bootstrap.min.js"></script>
    <script src="js/libs/highcharts.js"></script>
    <script src="js/libs/moment.min.js"></script>
    <script src="js/libs/es.js"></script>
    <script src="js/libs/bootstrap-datetimepicker.min.js"></script>
    <script src="js/main.js"></script>
    <script type="text/javascript">
        // datetimepicker
        $(function() {

            $("div[id^='datetimepicker']").datetimepicker({
                format: 'DD/MM/YYYY',
                locale: 'es'
            });

        });

        var dato, datoDefault, url = null;

        function getData(url) {

            var json = null;
            $.ajax({
                'async': false,
                'global': false,
                'url': url,
                'dataType': "json",
                'success': function(data) {
                    json = data;
                }
            });
            return json;
        }

        // formato numérico
        function formatoNumerico(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        // grafico cambiar los colores de las columnas
        $(function() {
            Highcharts.theme = {
                colors: ['#eaa4a9', '#e6c3a0', '#c8e6a0', '#a4e6a0', '#a0e6dc', '#a0d2e6']
            };
            Highcharts.setOptions(Highcharts.theme);
        });

        //historial-cargas-sector
        // grafico
        $(function() {

            var arrDia = [];
            var arrValor = [];
            var urlMensual = "./json/historial-cargas-mes-sector.json";
            var urlAnual = "./json/historial-cargas-ano-sector.json";
            var chart3 = [];
            var initialSeriesFromJSON = [{
                    name: "Data 1",
                    data: [1000, 800]
                },
                {
                    name: "Data 2",
                    data: [800, 648]
                },
                {
                    name: "Data 3",
                    data: [600, 534]
                },
                {
                    name: "Data 4",
                    data: [400, 213]
                },
            ];


            function getGraficoMensual(chart3) {
                url = urlMensual;
                dato = getData(url);
                var i = 0;
                arrDia = [];
                for (var prop in dato.fecha) {
                    arrDia.push(++i);
                }

                arrValor = [];
                for (var prop in dato.datos) {
                    arrValor.push(dato.datos[prop].valor);
                }
                
                chart3 = $('#historial-cargas-sector').highcharts();

//                chart3.yAxis[0].update({
//                    title: {
//                        text: dato.texto[0].y
//                    }
//                });
//
//                chart3.xAxis[0].update({
//                    title: {
//                        text: dato.texto[0].x
//                    },
//                    categories: arrDia
//                });
//
//
//                chart3.update({
//                    tooltip: {
//                        formatter: function() {
//                            return '<strong style="font-size: 14px;">$' + formatoNumerico(this.y) + '</strong><br><span style="font-size: 12px; font-weight: 300">' + dato.fecha[this.point.index] + '</span>';
//                        }
//                    }
//                });


                var updatedSeriesFromJSON = [
                    {
                        name: "Data 1",
                        data: [900, 950]
                    },
                    {
                        name: "Data 2",
                        data: [780, 700]
                    },
                    {
                        name: "Data 3",
                        data: [400, 600]
                    },
                    {
                        name: "Data 4",
                        data: [200, 250]
                    },
                ];


                $.each(updatedSeriesFromJSON, function(key, val) {
                    chart3.series[key].setData(val.data);
                });

            }

            function getGraficoAnual(chart3) {
                url = urlAnual;
                dato = getData(url);
                arrDia = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];

//                arrValor = [];
//                for (var prop in dato.datos) {
//                    arrValor.push(dato.datos[prop].data);
//                    arrValor = arrValor[0];
//                }
                chart3 = $('#historial-cargas-sector').highcharts();

                chart3.yAxis[0].update({
                    title: {
                        text: dato.texto[0].y
                    }
                });

                chart3.xAxis[0].update({
                    title: {
                        text: dato.texto[0].x
                    },
                    categories: arrDia
                });

                chart3.update({
                    tooltip: {
                        formatter: function() {
                            return '<strong style="font-size: 14px;">' + formatoNumerico(this.x) + '</strong><br><span style="font-size: 12px; font-weight: 300">$' + this.y + '</span>';
                        }
                    }
                });

                //chart3.series[0].setData(arrValor);
                //chart3.redraw();
                
                var updatedSeriesFromJSON = [
                    {
                        name: "Data 1",
                        data: [4, 5]
                    },
                    {
                        name: "Data 2",
                        data: [3, 6]
                    },                    
                    {
                        name: "Data 3",
                        data: [2, 7]
                    },
                    {
                        name: "Data 4",
                        data: [1, 8]
                    },
                ];


                $.each(updatedSeriesFromJSON, function(key, val) {
                    chart3.series[key].setData(val.data);
                });

            }
            
            if ($(".mes").hasClass("active")) {
                getGraficoMensual(chart3);
            //    dato = getData("./json/historial-cargas-mes-sector.json");
            } else if ($(".ano").hasClass("active")) {
              //  getGraficoAnual(chart3);
            //    dato = getData("./json/historial-cargas-ano-sector.json");
            }
            
            var initialSeriesFromJSON = [{
                    name: "Data 1",
                    data: [1000, 800]
                },
                {
                    name: "Data 2",
                    data: [800, 648]
                },
                {
                    name: "Data 3",
                    data: [600, 534]
                },
                {
                    name: "Data 4",
                    data: [400, 213]
                },
            ];

            var chart3 = $('#historial-cargas-sector').highcharts({
                chart: {
                    type: 'column'
                },
                title: {
                    text: '',
                    style: {
                        display: 'none'
                    }
                },
                subtitle: {
                    text: '',
                    style: {
                        display: 'none'
                    }
                },
                credits: {
                    enabled: false
                },
                exporting: {
                    enabled: false
                },
                legend: {
                    enabled: false
                },
                xAxis: {
                    lineWidth: 0,
                    tickWidth: 0,
                    categories: [''],
                    labels: {
                        enabled: true,
                        style: {
                            fontSize: '14px',
                            color: '#666666',
                            fontFamily: 'Muli',
                            fontWeight: 'normal'
                        }
                    },
                },
                yAxis: {
                    title: {
                        style: {
                            color: '#108cbd'
                        }
                    },
                    labels: {
                        format: '$ {value}',
                        style: {
                            color: '#108cbd'
                        }
                    },
                },
                tooltip: {
                    useHTML: true
                },
                plotOptions: {
                    series: {
                        point: {
                            events: {
                                mouseOver: function() {
                                    $(this.series.chart.xAxis[0].labelGroup.element.childNodes[this.x]).css({
                                        "fill": "#f6666c",
                                        "font-weight": "bold"
                                    });
                                },
                                mouseOut: function() {
                                    $(this.series.chart.xAxis[0].labelGroup.element.childNodes[this.x]).css({
                                        "fill": "#666666",
                                        "font-weight": "normal"
                                    });
                                }
                            }
                        }
                    },
                    column: {
                        stacking: 'normal',
                        borderWidth: 0,
                        grouping: false,
                        dataLabels: {
                            enabled: false,
                            color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white'
                        }
                    }
                },
                series: initialSeriesFromJSON

            });
            
           // var chart3 = $('#historial-cargas-sector').highcharts();


            $('.mes').click(function(e) {
                e.preventDefault();
                getGraficoMensual(chart3);
                $(this).addClass('active').siblings('.active').removeClass('active');
            });

            $('.ano').click(function(e) {
                e.preventDefault();
                getGraficoAnual(chart3);
                $(this).addClass('active').siblings('.active').removeClass('active');
            });

        });

    </script>

    <div class="mask"></div>
</body>

</html>
